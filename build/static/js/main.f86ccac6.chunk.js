(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{1068:function(e,t){},1070:function(e,t){},1081:function(e,t){},1083:function(e,t){},1108:function(e,t){},1110:function(e,t){},1111:function(e,t){},1116:function(e,t){},1118:function(e,t){},1137:function(e,t){},1149:function(e,t){},1152:function(e,t){},1157:function(e,t,n){"use strict";n.r(t);var r=n(0),c=n.n(r),a=n(29),o=n.n(a),i=(n(815),n(816),n(375)),s=n(10),u=n(1213),l=n(1212),j=n(1225),d=n(170),b=n(61),p=n(100),f=n(743),h=n(744),O=n(376);function x(){var e=localStorage.getItem("access_token");return!!e&&Object(O.a)(e).exp>(new Date).getTime()/1e3}var g=Object(f.a)(Object(h.devtools)((function(e){return{auth:x(),setAuth:function(t){return e((function(e){return{auth:t}}))},invoices:[],setInvoices:function(t){return e((function(e){return{invoices:t}}))},allIinvoices:[],setAllInvoices:function(t){return e((function(e){return{allInvoices:t}}))},invoiceStati:[],setInvoiceStati:function(t){return e((function(e){return{invoiceStati:t}}))},projectsteps:[],setProjectsteps:function(t){return e((function(e){return{projectsteps:t}}))},projectHonorar:[],setProjectHonorar:function(t){return e((function(e){return{projectHonorar:t}}))},projectdata:{},setProjectdata:function(t){return e((function(e){return{projectdata:t}}))},editClientData:{},setEditClientData:function(t){return e((function(e){return{editClientData:t}}))},cropImage:null,setCropImage:function(t){return e((function(e){return{cropImage:t}}))},cropModalOpen:!1,setCropModalOpen:function(t){return e((function(e){return{cropModalOpen:t}}))},openClient:!1,setOpenClient:function(t){return e((function(e){return{openClient:t}}))},projectModalOpen:!1,setProjectModalOpen:function(t){return e((function(e){return{projectModalOpen:t}}))},editModalOpen:!1,setEditModalOpen:function(t){return e((function(e){return{editModalOpen:t}}))},invoiceCreateModel:!1,setInvoiceCreateModel:function(t){return e((function(e){return{invoiceCreateModel:t}}))},invoiceEditModel:!1,setInvoiceEditModel:function(t){return e((function(e){return{invoiceEditModel:t}}))},createOfferModel:!1,setCreateOfferModel:function(t){return e((function(e){return{createOfferModel:t}}))}}}))),m=n.p+"static/media/ubc.ebb132ce.svg",v=n(2);var y=function(e){var t=e.children,n=c.a.useState(!1),r=Object(s.a)(n,2),a=r[0],o=r[1],f=g((function(e){return e.auth})),h=g((function(e){return e.setAuth})),O=Object(b.g)(),x=localStorage.getItem("profile_name"),y=Object(i.useMediaQuery)({query:"(max-width: 1224px)"}),w=Object(v.jsx)(u.a.Menu,{position:"right",children:Object(v.jsx)(l.a,{item:!0,text:x,children:Object(v.jsxs)(l.a.Menu,{children:[Object(v.jsx)(l.a.Item,{children:"Profile"}),Object(v.jsx)(l.a.Item,{onClick:function(){return h(!1),localStorage.removeItem("access_token"),localStorage.removeItem("profile_name"),void O.push("/login")},children:"Logout"})]})})});return Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)("div",{children:Object(v.jsxs)(u.a,{style:{margin:0},fixed:"top",children:[Object(v.jsx)(u.a.Item,{onClick:function(){o(!a)},children:Object(v.jsx)("i",{className:"fas fa-bars"})}),Object(v.jsx)(p.b,{to:"/",children:Object(v.jsx)(u.a.Item,{children:Object(v.jsx)("img",{style:{width:"80px"},src:m,alt:"logo"})})}),f?w:null]})}),Object(v.jsxs)(j.a.Pushable,{style:{},children:[Object(v.jsxs)(j.a,{as:u.a,animation:"push",icon:"labeled",vertical:!0,visible:a,width:"thin",style:{backgroundColor:"white",paddingTop:53.63},children:[Object(v.jsxs)(u.a.Item,{as:p.b,to:"/",children:[Object(v.jsx)(d.a,{name:"clipboard"}),"Projekte"]}),Object(v.jsxs)(u.a.Item,{as:p.b,to:"/clients",children:[Object(v.jsx)(d.a,{name:"address book"}),"Kunden"]}),Object(v.jsxs)(u.a.Item,{as:p.b,to:"/invoices",children:[Object(v.jsx)(d.a,{name:"eur"}),"Rechungen"]}),Object(v.jsxs)(u.a.Item,{as:p.b,to:"/forecast",children:[Object(v.jsx)(d.a,{name:"chart line"}),"Forecast"]})]}),Object(v.jsx)(j.a.Pusher,{style:{overflow:"scroll",height:"100vh",paddingTop:53.63,transition:"400ms",paddingRight:a&&!y?148:0},children:t})]})]})},w=n(8),k=n.n(w),C=n(13),S=n(1226),_=n(1227),E=n(1214),F=n(1172),I=n(747),D=n.n(I).a.create({baseURL:"https://ubcdata.herokuapp.com/api/",timeout:5e3,headers:{"Content-Type":"application/json",accept:"application/json"}});D.interceptors.request.use(function(){var e=Object(C.a)(k.a.mark((function e(t){var n;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=localStorage.getItem("access_token"))&&(t.headers.Authorization="Bearer ".concat(n)),e.abrupt("return",t);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),(function(e){return Promise.reject(e)})),D.interceptors.response.use((function(e){return e}),(function(e){if(401!==e.response.status)return Promise.reject(e);window.location.reload(!0)}));var R=D;var A=function(){Object(r.useEffect)((function(){console.log("http://127.0.0.1:8000/api/"),console.log(Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_API_URL:"http://127.0.0.1:8000/api/"}).REACT_APP_TEST),console.log("production")}),[]);var e=Object(r.useState)(""),t=Object(s.a)(e,2),n=t[0],c=t[1],a=Object(r.useState)(""),o=Object(s.a)(a,2),i=o[0],u=o[1],l=Object(r.useState)(""),j=Object(s.a)(l,2),d=j[0],p=j[1],f=g((function(e){return e.setAuth})),h=Object(b.g)(),x=function(){var e=Object(C.a)(k.a.mark((function e(){var t,r;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,R.post("token",{username:n,password:i});case 3:200===(t=e.sent).status&&(localStorage.setItem("access_token",t.data.access),localStorage.setItem("refresh_token",t.data.refresh),R.defaults.headers.Authorization="JWT "+localStorage.getItem("access_token"),r=Object(O.a)(t.data.access).name,localStorage.setItem("profile_name",r),f(!0),h.push("/")),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0.response.data),p(e.t0.response.data);case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();return Object(v.jsx)(S.a,{textAlign:"center",style:{height:"80%",maxWidth:"100%"},verticalAlign:"middle",children:Object(v.jsxs)(S.a.Column,{style:{maxWidth:420},children:[Object(v.jsx)(_.a,{as:"h2",color:"teal",textAlign:"center",children:"UBCDATA Log-in to your account"}),Object(v.jsxs)(E.a,{size:"large",children:[Object(v.jsx)(E.a.Input,{fluid:!0,icon:"user",iconPosition:"left",placeholder:"username",value:n,onChange:function(e){return c(e.target.value)}}),Object(v.jsx)(E.a.Input,{fluid:!0,error:d.detail&&{content:d.detail},icon:"lock",iconPosition:"left",placeholder:"Password",type:"password",value:i,onChange:function(e){return u(e.target.value)}}),Object(v.jsx)(F.a,{onClick:function(){return x()},color:"teal",fluid:!0,size:"large",children:"Login"})]})]})})},L=n(14),M=n(780);var P=function(e){var t=e.component,n=Object(M.a)(e,["component"]),c=g((function(e){return e.auth})),a=g((function(e){return e.setAuth}));return Object(r.useEffect)((function(){c&&a(x())}),[]),Object(v.jsx)(b.b,Object(L.a)(Object(L.a)({},n),{},{render:function(e){return c?Object(v.jsx)(t,Object(L.a)(Object(L.a)({},n),e)):Object(v.jsx)(b.a,{to:"/login"})}}))},z=n(1216),T=n(164),H=n.n(T),K=n(1211);var U=function(e){var t=e.data,n=e.status,c=e.isLoading,a=e.rerenderfunc,o=Object(r.useState)(!1),i=Object(s.a)(o,2),u=i[0],l=i[1],j=Object(r.useState)({}),d=Object(s.a)(j,2),p=d[0],f=d[1],h=Object(b.g)(),O=g((function(e){return e.setProjectModalOpen})),x=function(){var e=Object(C.a)(k.a.mark((function e(){return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,R.delete("/projects/".concat(p.id));case 3:a(),l(!1),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0.response);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),m={},y=[];return c||(n.forEach((function(e){m[e.id]=e.name})),y=t.map((function(e){var t=new Date(e.created_at).toLocaleDateString("de",{hour:"numeric",minute:"numeric"});return{id:e.id,title:e.title,project_number:e.project_number,client:e.client&&e.client.name,created_at:t,status:e.status&&e.status.id,honorar:e.honorar}}))),Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)(H.a,{isLoading:c,title:"Projektliste",columns:[{title:"Nr.",field:"project_number"},{title:"Titel",field:"title",render:function(e){return Object(v.jsx)(v.Fragment,{children:e.title.length>17?Object(v.jsx)(K.a,{content:e.title,trigger:Object(v.jsx)("p",{children:e.title.slice(0,17)+"..."})}):Object(v.jsx)("p",{children:e.title})})}},{title:"Kunde",field:"client"},{title:"Erstellt",field:"created_at",type:"datetime"},{title:"Status",field:"status",lookup:m},{title:"Honorar",field:"honorar",type:"currency",currencySetting:{locale:"de",currencyCode:"EUR"}}],data:y,options:{actionsColumnIndex:-1,sorting:!0,filtering:!0,exportButton:!0,pageSize:10,padding:"dense"},actions:[{icon:"edit",tooltip:"Projektdetails",onClick:function(e,t){h.push("/projects/".concat(t.id))}},{icon:"add",tooltip:"Neues Projekt",isFreeAction:!0,onClick:function(){O(!0)}},{icon:"delete",tooltip:"Projekt l\xf6schen",onClick:function(e,t){console.log(t),f(t),l(!0)}}]}),Object(v.jsxs)(z.a,{open:u,onClose:function(){return l(!1)},children:[Object(v.jsx)(z.a.Header,{children:"Projekt l\xf6schen"}),Object(v.jsxs)(z.a.Content,{children:["Das Project"," ",Object(v.jsxs)("strong",{children:[p.title," (",p.client,")"]})," ","wirklich l\xf6schen ?"]}),Object(v.jsxs)(z.a.Actions,{children:[Object(v.jsx)(F.a,{negative:!0,onClick:function(){return l(!1)},children:"Abbrechen"}),Object(v.jsx)(F.a,{positive:!0,onClick:function(){return x()},children:"L\xf6schen"})]})]})]})},B=n(422),N=n(1229),V=n(1228),W=n(1194),q=n(781),Z=n(414),G=n.n(Z),J=n.p+"static/media/sample.99776b0e.svg",Q=n(751),X=n(752),Y=function(e){return new Promise((function(t,n){var r=new Image;r.addEventListener("load",(function(){return t(r)})),r.addEventListener("error",(function(e){return n(e)})),r.setAttribute("crossOrigin","anonymous"),r.src=e}))};function $(e,t){return ee.apply(this,arguments)}function ee(){return(ee=Object(C.a)(k.a.mark((function e(t,n){var r,c,a;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Y(t);case 2:return r=e.sent,(c=document.createElement("canvas")).width=n.width,c.height=n.height,(a=c.getContext("2d")).fillStyle="#ffffff",a.fillRect(0,0,c.width,c.height),a.drawImage(r,n.x,n.y,n.width,n.height,0,0,n.width,n.height),e.abrupt("return",new Promise((function(e,t){c.toBlob((function(t){e(URL.createObjectURL(t))}),"image/jpeg")})));case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var te=n(782);var ne=function(){var e=Object(r.useState)({x:0,y:0}),t=Object(s.a)(e,2),n=t[0],c=t[1],a=Object(r.useState)(1),o=Object(s.a)(a,2),i=o[0],u=o[1],l=Object(r.useState)(null),j=Object(s.a)(l,2),d=j[0],b=j[1],p=g((function(e){return e.setCropImage})),f=g((function(e){return e.setCropModalOpen})),h=Object(r.useCallback)((function(e,t){b(t)}),[]),O=function(){var e=Object(C.a)(k.a.mark((function e(){var t,n;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=window.imageq,e.prev=1,e.next=4,$(t,d);case 4:n=e.sent,p(n),f(!1),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),console.error(e.t0);case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(){return e.apply(this,arguments)}}(),x={start:0,min:0,max:3,step:.01,onChange:function(e){u(e)}};return Object(v.jsx)(v.Fragment,{children:Object(v.jsx)(Q.Gluejar,{onError:function(e){return console.error(e)},children:function(e){var t=e.images;return window.imageq=t.slice(-1),Object(v.jsx)(v.Fragment,{children:Object(v.jsx)(V.a,{textAlign:"center",compact:!0,style:{padding:"1rem"},children:t.length>0?Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)(X.Slider,{style:{marginBottom:"1rem"},value:i,color:"red",settings:x}),Object(v.jsx)("div",{style:{position:"relative",height:"250px",width:"250px"},children:Object(v.jsx)(v.Fragment,{children:Object(v.jsx)(te.a,{cropSize:{width:200,height:200},image:window.imageq,crop:n,zoom:i,min:1,max:3,restrictPosition:!1,aspect:1,onCropChange:c,onCropComplete:h})})}),Object(v.jsx)(F.a,{style:{marginTop:"1rem"},onClick:function(){return O()},children:"Cut Image"})]}):Object(v.jsx)("div",{style:{height:"200px",width:"200px",display:"flex",alignItems:"center",justifyContent:"center"},children:Object(v.jsx)("h4",{children:"Paste Image"})})})})}})})};var re=function(){var e=g((function(e){return[e.cropModalOpen,e.setCropModalOpen]})),t=Object(s.a)(e,2),n=t[0],c=t[1],a=Object(r.useState)(""),o=Object(s.a)(a,2),i=o[0],u=o[1],j=Object(r.useState)(""),d=Object(s.a)(j,2),b=d[0],p=d[1],f=Object(r.useState)({}),h=Object(s.a)(f,2),O=h[0],x=h[1],m=g((function(e){return e.cropImage})),y=g((function(e){return e.setOpenClient})),w=Object(r.useState)([]),S=Object(s.a)(w,2),_=S[0],I=S[1],D=Object(r.useState)(),A=Object(s.a)(D,2),L=A[0],M=A[1],P=function(){var e=Object(C.a)(k.a.mark((function e(){var t;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,R.get("/artikel/");case 3:t=e.sent,console.log(t.data),I(t.data),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}(),T=function(){var e=Object(C.a)(k.a.mark((function e(){var t,n,r;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log(m),e.prev=1,t=new FormData,null==m){e.next=11;break}return e.next=6,fetch(m).then((function(e){return e.blob()})).then((function(e){return new File([e],"".concat(i.replace(".","-").replace(" ","-"),".jpeg"),{type:"image/jpeg"})}));case 6:return n=e.sent,e.next=9,G()({file:n,width:300,height:300,type:"jpeg"});case 9:r=e.sent,t.append("image",r);case 11:return t.append("name",i),t.append("short",b),t.append("artikel",L),e.next=16,R.post("/kunden/",t);case 16:y(!1),e.next=23;break;case 19:e.prev=19,e.t0=e.catch(1),console.log(e.t0.response),x(e.t0.response.data);case 23:case"end":return e.stop()}}),e,null,[[1,19]])})));return function(){return e.apply(this,arguments)}}();return Object(r.useEffect)((function(){P()}),[]),Object(v.jsxs)("div",{children:[Object(v.jsxs)("div",{style:{width:"250px"},children:[Object(v.jsx)(q.a,{fluid:!0,src:m||J,onClick:function(){return c(!0)},style:{cursor:"pointer",padding:"1rem"}}),Object(v.jsxs)(E.a,{children:[Object(v.jsx)(E.a.Field,{onChange:function(e){return u(e.target.value)},value:i,control:W.a,error:O.name&&{content:O.name,pointing:"below"},placeholder:"Name"}),Object(v.jsx)(E.a.Field,{onChange:function(e){return p(e.target.value)},value:b,control:W.a,error:O.short&&{content:O.short,pointing:"below"},placeholder:"K\xfcrzel (max. 5 Characters)"}),Object(v.jsx)(E.a.Field,{selection:!0,control:l.a,error:O.artikel&&{content:"Artikel w\xe4hlen",pointing:"below"},onChange:function(e,t){return M(t.value)},fluid:!0,placeholder:"Artikel (z.B. das Klinikum)",options:_.map((function(e){return{value:e.id,text:e.nominativ}}))})]}),Object(v.jsx)(F.a,{onClick:function(){return T()},style:{display:"block",width:"100%",marginTop:".5rem"},content:"Erstellen"})]}),Object(v.jsxs)(z.a,{size:"mini",open:n,onClose:function(){return c(!1)},children:[Object(v.jsx)(z.a.Header,{children:"Trim Image"}),Object(v.jsx)(z.a.Content,{style:{display:"flex",alignItems:"center",justifyContent:"center"},children:Object(v.jsx)(ne,{})})]})]})};var ce=function(){var e=Object(r.useState)([]),t=Object(s.a)(e,2),n=t[0],c=t[1],a=Object(r.useState)({}),o=Object(s.a)(a,2),i=o[0],u=o[1],j=g((function(e){return[e.openClient,e.setOpenClient]})),d=Object(s.a)(j,2),b=d[0],p=d[1],f=Object(r.useState)([]),h=Object(s.a)(f,2),O=h[0],x=h[1],m=Object(r.useState)({}),y=Object(s.a)(m,2),w=y[0],S=y[1],I=g((function(e){return e.setProjectModalOpen})),D=function(){var e=Object(C.a)(k.a.mark((function e(){return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,R.post("/addProject/",Object(L.a)(Object(L.a)({},i),{},{status:1}));case 3:I(!1),e.next=10;break;case 6:e.prev=6,e.t0=e.catch(0),console.log(e.t0.response),S(e.t0.response.data);case 10:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(){return e.apply(this,arguments)}}(),A=function(){var e=Object(C.a)(k.a.mark((function e(){var t;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,R.get("/clients/");case 3:t=e.sent,c(t.data.map((function(e){return{value:e.id,image:e.image,short:e.short,text:e.name}}))),u((function(e){return Object(L.a)(Object(L.a)({},e),{},{client:Math.max.apply(Math,Object(B.a)(t.data.map((function(e){return e.id}))))})})),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0.response);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}(),M=function(){var e=Object(C.a)(k.a.mark((function e(){var t;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,R.get("/types/");case 3:t=e.sent,console.log(t),x(t.data.map((function(e){return{value:e.id,text:e.name,short:e.short}}))),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0.response);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}();return Object(r.useEffect)((function(){A(),M()}),[b]),Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)(N.a,{open:b,children:Object(v.jsxs)(V.a,{style:{left:0,right:0,marginLeft:"auto",marginRight:"auto",position:"fixed",width:"280px",top:"20%",zIndex:1e3},children:[Object(v.jsx)(_.a,{children:"Neuen Kunden anlegen"}),Object(v.jsx)(re,{}),Object(v.jsx)(F.a,{style:{marginTop:".5rem"},fluid:!0,content:"Abbrechen",negative:!0,onClick:function(){return p(!1)}})]})}),Object(v.jsx)(z.a.Header,{children:"Neues Projekt"}),Object(v.jsx)(z.a.Content,{children:Object(v.jsxs)(E.a,{children:[Object(v.jsx)(E.a.Field,{label:"Title",control:W.a,error:w.title&&{content:w.title,pointing:"below"},onChange:function(e){return u((function(t){return Object(L.a)(Object(L.a)({},t),{},{title:e.target.value})}))},placeholder:"Title"}),Object(v.jsx)(E.a.Field,{selection:!0,label:"Typ",control:l.a,error:w.project_type&&{content:w.project_type,pointing:"below"},onChange:function(e,t){return u((function(e){return Object(L.a)(Object(L.a)({},e),{},{project_type:t.value})}))},fluid:!0,placeholder:"Projekttyp w\xe4hlen",options:O}),Object(v.jsx)(E.a.Field,{search:!0,selection:!0,control:l.a,label:"Kunde",value:i.client,error:w.client&&{content:w.client,pointing:"below"},onChange:function(e,t){u((function(e){return Object(L.a)(Object(L.a)({},e),{},{client:t.value})}))},fluid:!0,placeholder:"Kunde ausw\xe4hlen",options:n}),Object(v.jsx)(F.a,{onClick:function(){p(!0)},icon:"add",label:"Neuer Kunde"})]})}),Object(v.jsxs)(z.a.Actions,{children:[Object(v.jsx)(F.a,{negative:!0,onClick:function(){return I(!1)},children:"Abbrechen"}),Object(v.jsx)(F.a,{positive:!0,onClick:function(){return D()},children:"Projekt anlegen"})]})]})},ae=n(637);var oe=function(){var e=g((function(e){return e.projectModalOpen})),t=Object(r.useState)(!0),n=Object(s.a)(t,2),c=n[0],a=n[1],o=Object(r.useState)(void 0),i=Object(s.a)(o,2),u=i[0],l=i[1],j=Object(r.useState)(void 0),d=Object(s.a)(j,2),b=d[0],p=d[1],f=Object(r.useState)(0),h=Object(s.a)(f,2),O=h[0],x=h[1],m=function(){var e=Object(C.a)(k.a.mark((function e(){var t;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,R.get("status");case 3:t=e.sent,p(t.data),e.next=10;break;case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",e.t0.message);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),y=function(){var e=Object(C.a)(k.a.mark((function e(){var t,n,r;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,R.get("projects/");case 3:return t=e.sent,e.next=6,R.get("/invoicesall/");case 6:n=e.sent,r=t.data.map((function(e){var t=n.data.filter((function(t){return t.project===e.id})).map((function(e){return parseFloat(e.amount)}));return Object(L.a)(Object(L.a)({},e),{},{honorar:ae.sum(t)})})),l(r),console.log(r),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),console.log(e.t0);case 15:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(){return e.apply(this,arguments)}}();return Object(r.useEffect)((function(){u&&b&&a(!1)}),[u,b]),Object(r.useEffect)((function(){y(),m()}),[e,O]),Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)(S.a,{stackable:!0,columns:3,children:Object(v.jsx)(S.a.Row,{stretched:!0,children:Object(v.jsx)(S.a.Column,{width:16,children:Object(v.jsx)(U,{data:u,isLoading:c,status:b,rerenderfunc:function(){x((function(e){return e+1}))}})})})}),Object(v.jsx)(z.a,{open:e,children:Object(v.jsx)(ce,{})})]})};var ie=function(e){var t=e.data,n=e.editPortal,c=e.updateSite,a=Object(r.useState)(!1),o=Object(s.a)(a,2),i=o[0],u=o[1],l=Object(r.useState)({}),j=Object(s.a)(l,2),d=j[0],b=j[1],p=g((function(e){return e.setOpenClient})),f=g((function(e){return e.setEditClientData})),h=function(){var e=Object(C.a)(k.a.mark((function e(t){return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,R.delete("clients/".concat(t));case 3:u(!1),e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),console.log(e.t0);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t){return e.apply(this,arguments)}}();return Object(r.useEffect)((function(){c()}),[i]),Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)(H.a,{test:i,title:"Kundenliste",columns:[{title:"Logo",field:"image",render:function(e){return console.log(e.image),Object(v.jsx)(q.a,{bordered:!0,src:e.image,style:{height:"30px",background:"transparent"},rounded:!0})}},{title:"Kunde",field:"name"},{title:"Kurz",field:"short"}],data:t,options:{actionsColumnIndex:-1,sorting:!0,exportButton:!0,pageSize:10,padding:"dense"},actions:[{icon:"edit",tooltip:"Projektdetails",onClick:function(e,t){n(!0),console.log(t),f(t)}},{icon:"delete",tooltip:"Projekt l\xf6schen",onClick:function(e,t){console.log(t),b(t),u(!0)}},{icon:"add",isFreeAction:!0,onClick:function(){p(!0)}}]}),Object(v.jsxs)(z.a,{open:i,onClose:function(){return u(!1)},children:[Object(v.jsx)(z.a.Header,{children:"Kunde l\xf6schen"}),Object(v.jsxs)(z.a.Content,{children:["Das Project ",Object(v.jsx)("strong",{children:d.name})," wirklich l\xf6schen ?"]}),Object(v.jsxs)(z.a.Actions,{children:[Object(v.jsx)(F.a,{negative:!0,onClick:function(){return u(!1)},children:"Abbrechen"}),Object(v.jsx)(F.a,{positive:!0,onClick:function(){return h(d.id)},children:"L\xf6schen"})]})]})]})};var se=function(e){var t=e.editPortal,n=g((function(e){return[e.cropModalOpen,e.setCropModalOpen]})),c=Object(s.a)(n,2),a=c[0],o=c[1],i=g((function(e){return e.editClientData})),u=Object(r.useState)(i.name),j=Object(s.a)(u,2),d=j[0],b=j[1],p=Object(r.useState)(i.short),f=Object(s.a)(p,2),h=f[0],O=f[1],x=Object(r.useState)({}),m=Object(s.a)(x,2),y=m[0],w=m[1],S=g((function(e){return e.cropImage})),_=Object(r.useState)([]),I=Object(s.a)(_,2),D=I[0],A=I[1],L=Object(r.useState)(i.artikel),M=Object(s.a)(L,2),P=M[0],T=M[1],H=function(){var e=Object(C.a)(k.a.mark((function e(){var t;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,R.get("/artikel/");case 3:t=e.sent,console.log(t.data),A(t.data),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}(),K=function(){var e=Object(C.a)(k.a.mark((function e(){var n,r,c;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log(S),e.prev=1,n=new FormData,null==S){e.next=11;break}return e.next=6,fetch(S).then((function(e){return e.blob()})).then((function(e){return new File([e],"".concat(d.replace(".","-").replace(" ","-"),".jpeg"),{type:"image/jpeg"})}));case 6:return r=e.sent,e.next=9,G()({file:r,width:300,height:300,type:"jpeg"});case 9:c=e.sent,n.append("image",c);case 11:return n.append("name",d),n.append("short",h),n.append("artikel",P),e.next=16,R.put("/clients/".concat(i.id,"/"),n);case 16:t(!1),e.next=23;break;case 19:e.prev=19,e.t0=e.catch(1),console.log(e.t0.response),w(e.t0.response.data);case 23:case"end":return e.stop()}}),e,null,[[1,19]])})));return function(){return e.apply(this,arguments)}}();return Object(r.useEffect)((function(){H()}),[]),Object(v.jsxs)("div",{children:[Object(v.jsxs)("div",{style:{width:"250px"},children:[Object(v.jsx)(q.a,{fluid:!0,src:S||i.image,onClick:function(){return o(!0)},style:{cursor:"pointer",padding:"1rem"}}),Object(v.jsxs)(E.a,{children:[Object(v.jsx)(E.a.Field,{onChange:function(e){return b(e.target.value)},value:d,control:W.a,error:y.name&&{content:y.name,pointing:"below"},placeholder:"Name"}),Object(v.jsx)(E.a.Field,{onChange:function(e){return O(e.target.value)},value:h,control:W.a,error:y.short&&{content:y.short,pointing:"below"},placeholder:"Name"}),Object(v.jsx)(E.a.Field,{selection:!0,control:l.a,value:P,onChange:function(e,t){return T(t.value)},fluid:!0,placeholder:"Artikel (z.B. das Klinikum)",options:D.map((function(e){return{value:e.id,text:e.nominativ}}))})]}),Object(v.jsx)(F.a,{onClick:function(){return K()},style:{display:"block",width:"100%",marginTop:".5rem"},content:"Aktualisieren"})]}),Object(v.jsxs)(z.a,{size:"mini",open:a,onClose:function(){return o(!1)},children:[Object(v.jsx)(z.a.Header,{children:"Trim Image"}),Object(v.jsx)(z.a.Content,{style:{display:"flex",alignItems:"center",justifyContent:"center"},children:Object(v.jsx)(ne,{})})]})]})};var ue=function(){var e=Object(r.useState)([]),t=Object(s.a)(e,2),n=t[0],c=t[1],a=g((function(e){return[e.openClient,e.setOpenClient]})),o=Object(s.a)(a,2),i=o[0],u=o[1],l=Object(r.useState)(0),j=Object(s.a)(l,2),d=j[0],b=j[1],p=Object(r.useState)(!1),f=Object(s.a)(p,2),h=f[0],O=f[1],x=function(e){O(e)},m=function(){var e=Object(C.a)(k.a.mark((function e(){var t;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,R.get("/clients/");case 3:t=e.sent,c(t.data),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0.response);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();return Object(r.useEffect)((function(){m()}),[i,h,d]),Object(v.jsxs)("div",{children:[Object(v.jsx)(ie,{updateSite:function(){b((function(e){return e+1}))},data:n,editPortal:x}),Object(v.jsx)(N.a,{open:i,children:Object(v.jsxs)(V.a,{style:{left:0,right:0,marginLeft:"auto",marginRight:"auto",position:"fixed",width:"280px",top:"20%",zIndex:1e3},children:[Object(v.jsx)(_.a,{children:"Neuen Kunden anlegen"}),Object(v.jsx)(re,{}),Object(v.jsx)(F.a,{style:{marginTop:".5rem"},fluid:!0,content:"Abbrechen",negative:!0,onClick:function(){return u(!1)}})]})}),Object(v.jsx)(N.a,{open:h,children:Object(v.jsxs)(V.a,{style:{left:0,right:0,marginLeft:"auto",marginRight:"auto",position:"fixed",width:"280px",top:"20%",zIndex:1e3},children:[Object(v.jsx)(_.a,{children:"Kunden bearbeiten"}),Object(v.jsx)(se,{editPortal:x}),Object(v.jsx)(F.a,{style:{marginTop:".5rem"},fluid:!0,content:"Abbrechen",negative:!0,onClick:function(){return O(!1)}})]})})]})},le=n(1218),je=n(1223),de=n(1205),be=n(754),pe=n(637),fe=function(e){var t=e.filepath,n=e.filename,r=e.data,c=e.render,a=function(){var e=Object(C.a)(k.a.mark((function e(t){var n,r;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t);case 2:return n=e.sent,e.next=5,n.blob();case 5:return r=e.sent,e.abrupt("return",r);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),o=function(){var e=Object(C.a)(k.a.mark((function e(t,n,r){var c,a;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t);case 2:return c=e.sent,e.next=5,c.blob();case 5:return a=e.sent,e.abrupt("return",{_type:"image",source:a,format:a.type,width:n,height:r});case 7:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}();function i(e,t){var n=URL.createObjectURL(t),r=document.createElement("a");r.download=e,r.href=n,document.body.appendChild(r),r.click(),setTimeout((function(){r.remove(),window.URL.revokeObjectURL(n),r=null}),0)}var s=function(){var e=Object(C.a)(k.a.mark((function e(){return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Object.keys(r).forEach((function(e){r[e]&&(pe.isArray(r[e])?r[e].forEach((function(t,n){Object.keys(t).forEach((function(t){r[e][n][t].isImage&&o(r[e][n][t].url,r[e][n][t].width,r[e][n][t].height).then((function(c){return r[e][n][t]=c}))}))})):r[e].isImage&&o(r[e].url,r[e].width,r[e].height).then((function(t){return r[e]=t})))})),e.abrupt("return",r);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return c(function(){var e=Object(C.a)(k.a.mark((function e(){var r,c,o,u;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=new be.a,e.next=3,a(t);case 3:return c=e.sent,e.next=6,s();case 6:return o=e.sent,console.log(o),e.next=10,r.process(c,o);case 10:u=e.sent,i(n,u);case 12:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}())};fe.defaultProps={render:function(e){return Object(v.jsx)("button",{onClick:function(){return e()},children:"Word-Document"})}};var he=fe,Oe=n(216);var xe=function(){var e=Object(r.useState)({}),t=Object(s.a)(e,2),n=t[0],c=t[1],a=Object(r.useState)({}),o=Object(s.a)(a,2),i=o[0],u=o[1],l=g((function(e){return e.setInvoiceCreateModel})),j=g((function(e){return e.projectdata})),d=function(){var e=Object(C.a)(k.a.mark((function e(){var t;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,R.post("/invoices/",Object(L.a)(Object(L.a)({},n),{},{project:j.id,status:1}));case 3:t=e.sent,console.log(t.data),l(!1),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0.response),u(e.t0.response.data);case 12:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}();return Object(r.useEffect)((function(){}),[]),Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)(z.a.Header,{children:"Neue Rechnung"}),Object(v.jsx)(z.a.Content,{children:Object(v.jsxs)(E.a,{children:[Object(v.jsx)(E.a.Field,{label:"Rechnungsname",control:W.a,error:i.title&&{content:i.title,pointing:"below"},onChange:function(e){return c((function(t){return Object(L.a)(Object(L.a)({},t),{},{title:e.target.value})}))},placeholder:"Title"}),Object(v.jsxs)(E.a.Field,{error:i.amount&&{content:i.amount,pointing:"below"},children:[Object(v.jsx)("label",{children:"Rechnungsbetrag"}),Object(v.jsx)(Oe.a,{placeholder:"Betrag in \u20ac (netto)",value:n.amount,onValueChange:function(e){var t=e.value;c((function(e){return Object(L.a)(Object(L.a)({},e),{},{amount:t})}))},isNumericString:!0,decimalScale:2,thousandSeparator:".",decimalSeparator:",",prefix:"\u20ac ",customInput:W.a})]}),Object(v.jsx)(E.a.Field,{label:"Vorraussichtliche Rechnungsstellung",control:W.a,error:i.date_of_payment&&{content:i.date_of_payment,pointing:"below"},onChange:function(e){return c((function(t){return Object(L.a)(Object(L.a)({},t),{},{date_of_payment:e.target.value})}))},placeholder:"Title",type:"date"})]})}),Object(v.jsxs)(z.a.Actions,{children:[Object(v.jsx)(F.a,{negative:!0,onClick:function(){return l(!1)},children:"Disagree"}),Object(v.jsx)(F.a,{positive:!0,onClick:function(){return d()},children:"Agree"})]})]})};var ge=function(e){var t=e.invoiceID,n=g((function(e){return e.invoices})).find((function(e){return e.id===t})),c=Object(r.useState)({}),a=Object(s.a)(c,2),o=a[0],i=a[1],u=Object(r.useState)(Object(L.a)({},n)),j=Object(s.a)(u,2),d=j[0],b=j[1],p=Object(r.useState)({}),f=Object(s.a)(p,1)[0],h=g((function(e){return e.setInvoiceEditModel})),O=g((function(e){return e.invoiceStati})),x=function(){var e=Object(C.a)(k.a.mark((function e(){var t,r;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,2!==d.status||null!==n.invoice_number){e.next=10;break}return t=o.number.toString().length<4?"0"+o.number:"".concat(o.number),r="".concat(o.short,"-").concat(o.year,"-").concat(t),e.next=6,R.put("invoices/".concat(n.id),Object(L.a)(Object(L.a)({},d),{},{invoice_number:r}));case 6:return e.next=8,R.put("invoice-number/".concat(o.id,"/"),Object(L.a)(Object(L.a)({},o),{},{number:o.number+1}));case 8:e.next=12;break;case 10:return e.next=12,R.put("invoices/".concat(n.id),Object(L.a)(Object(L.a)({},d),{},{invoice_number:n.invoice_number}));case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(0),console.log(e.t0.response);case 17:h(!1);case 18:case"end":return e.stop()}}),e,null,[[0,14]])})));return function(){return e.apply(this,arguments)}}(),m=function(){var e=Object(C.a)(k.a.mark((function e(){var t,n;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,R.get("/invoice-number/");case 3:t=e.sent,n=t.data[0],i(n),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0.response);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}();return Object(r.useEffect)((function(){m()}),[]),Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)(z.a.Header,{children:"Rechnung Bearbeiten"}),Object(v.jsx)(z.a.Content,{children:Object(v.jsxs)(E.a,{children:[Object(v.jsx)(E.a.Field,{label:"Rechnungsname",control:W.a,value:d.title,error:f.name&&{content:f.name,pointing:"below"},onChange:function(e){return b((function(t){return Object(L.a)(Object(L.a)({},t),{},{title:e.target.value})}))},placeholder:"Title"}),Object(v.jsxs)(E.a.Field,{children:[Object(v.jsx)("label",{children:"Rechnungsbetrag"}),Object(v.jsx)(Oe.a,{placeholder:"Betrag in \u20ac (netto)",value:d.amount,onValueChange:function(e){console.log(e);var t=e.value;b((function(e){return Object(L.a)(Object(L.a)({},e),{},{amount:t})}))},isNumericString:!0,decimalScale:2,thousandSeparator:".",decimalSeparator:",",prefix:"\u20ac ",customInput:W.a})]}),Object(v.jsx)(E.a.Field,{selection:!0,label:"Status",control:l.a,value:d.status,error:f.project_type&&{content:f.project_type,pointing:"below"},onChange:function(e,t){return b((function(e){return Object(L.a)(Object(L.a)({},e),{},{status:t.value})}))},fluid:!0,placeholder:"Projekttyp w\xe4hlen",options:O}),Object(v.jsx)(E.a.Field,{label:"Rechnungsstellung",control:W.a,disabled:1===d.status,value:d.date_of_invoicing,error:f.name&&{content:f.name,pointing:"below"},onChange:function(e){return b((function(t){return Object(L.a)(Object(L.a)({},t),{},{date_of_invoicing:e.target.value})}))},placeholder:"Title",type:"date"}),Object(v.jsx)(E.a.Field,{label:"Vorraussichtlicher Zahlungseingang",control:W.a,value:d.date_of_payment,error:f.name&&{content:f.name,pointing:"below"},onChange:function(e){return b((function(t){return Object(L.a)(Object(L.a)({},t),{},{date_of_payment:e.target.value})}))},placeholder:"Title",type:"date"})]})}),Object(v.jsxs)(z.a.Actions,{children:[Object(v.jsx)(F.a,{negative:!0,onClick:function(){return h(!1)},children:"Disagree"}),Object(v.jsx)(F.a,{positive:!0,onClick:function(){return x()},children:"Agree"})]})]})},me=n.p+"static/media/re_vorlage.0c790b2b.docx";var ve=function(e){var t=e.projectID,n=new Intl.NumberFormat("de",{style:"currency",currency:"EUR"}),c=g((function(e){return[e.invoices,e.setInvoices]})),a=Object(s.a)(c,2),o=a[0],i=a[1],u=g((function(e){return[e.invoiceCreateModel,e.setInvoiceCreateModel]})),l=Object(s.a)(u,2),j=l[0],b=l[1],p=g((function(e){return[e.invoiceEditModel,e.setInvoiceEditModel]})),f=Object(s.a)(p,2),h=f[0],O=f[1],x=g((function(e){return[e.invoiceStati,e.setInvoiceStati]})),m=Object(s.a)(x,2),y=m[0],w=m[1],S=Object(r.useState)([]),_=Object(s.a)(S,2),E=_[0],I=_[1],D=g((function(e){return e.projectdata})),A=function(){var e=Object(C.a)(k.a.mark((function e(){var t;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,R.get("/artikel/");case 3:t=e.sent,I(t.data),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),M=function(){var e=Object(C.a)(k.a.mark((function e(){var t;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,R.get("/invoicestatus/");case 3:t=e.sent,w(t.data.map((function(e){return{value:e.id,text:e.name,icon:e.icontext}}))),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),P=Object(r.useState)(!0),T=Object(s.a)(P,2),U=T[0],B=T[1],N=Object(r.useState)(!1),V=Object(s.a)(N,2),W=V[0],q=V[1],Z=Object(r.useState)({}),G=Object(s.a)(Z,2),J=G[0],Q=G[1],X=function(){var e=Object(C.a)(k.a.mark((function e(){var n;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,R.get("invoices",{params:{id:t}});case 3:n=e.sent,i(n.data),B(!1),e.next=11;break;case 8:return e.prev=8,e.t0=e.catch(0),e.abrupt("return",e.t0.message);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}(),Y=function(){var e=Object(C.a)(k.a.mark((function e(t){return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,R.delete("invoices/".concat(t));case 3:e.next=8;break;case 5:return e.prev=5,e.t0=e.catch(0),e.abrupt("return",e.t0.response);case 8:q(!1);case 9:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(t){return e.apply(this,arguments)}}(),$=function(){var e=Object(C.a)(k.a.mark((function e(t){var n,r;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=o.findIndex((function(e){return e.id===t})),e.next=4,R.put("invoices/".concat(t),Object(L.a)(Object(L.a)({},o[n]),{},{status:3===o[n].status?1:o[n].status+1}));case 4:r=e.sent,i(o.map((function(e,t){return t===n?r.data:e}))),e.next=11;break;case 8:return e.prev=8,e.t0=e.catch(0),e.abrupt("return",e.t0.message);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}();return Object(r.useEffect)((function(){M(),A()}),[]),Object(r.useEffect)((function(){X()}),[j,W,h]),Object(r.useEffect)((function(){console.log(o)}),[o]),Object(v.jsxs)(v.Fragment,{children:[U?Object(v.jsx)(je.a,{active:!0,inverted:!0,children:Object(v.jsx)(de.a,{size:"medium",children:"Loading"})}):Object(v.jsx)(H.a,{title:"Rechnungen",style:{boxShadow:"none"},columns:[{title:"Name",field:"title"},{title:"RN",field:"invoice_number"},{title:"Betrag",field:"amount",type:"currency",currencySetting:{locale:"de",currencyCode:"EUR"}},{title:"Status",field:"status",render:function(e){var t=y.find((function(t){return t.value===e.status}));return Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)("span",{style:{marginRight:".2rem"},children:t&&t.text}),Object(v.jsx)(d.a,{color:t&&3===t.value?"green":t&&2===t.value?"yellow":"black",name:t&&t.icon})]})}},{title:"Stellung",field:"date_of_invoicing",type:"date"},{title:"Eingang",field:"date_of_payment",type:"date",render:function(e){var t=new Date(e.date_of_payment).toLocaleDateString("de");return Object(v.jsx)("span",{style:{color:3===e.status?"#016936":"#CFCCD6"},children:t})}}],actions:[{icon:"word",color:"grey",tooltip:"status",onClick:function(e,t){$(t.id)}},{icon:"edit",color:"blue",tooltip:"Bearbeiten",onClick:function(e,t){Q(t),O(!0)}},{icon:"delete",color:"red",tooltip:"Rechnung l\xf6schen",onClick:function(e,t){Q(t),q(!0)}},{icon:"add",tooltip:"Neue Rechnung",color:"grey",isFreeAction:!0,onClick:function(e){return b(!0)}}],components:{Action:function(e){var t=e.data,r=E.find((function(e){return D.client&&e.id===D.client.artikel})),c=[];D.part&&c.push({item:D.part}),D.contact&&c.push({item:D.contact}),D.street&&c.push({item:D.street}),D.plz&&D.place&&c.push({item:D.plz+" "+D.place});var a={date:(new Date).toLocaleDateString("de"),logo:{isImage:!0,url:D.client&&D.client.image,width:20,height:20},invoice_number:t.invoice_number,netto:n.format(t.amount),tax:n.format(.19*t.amount),brutto:n.format(1.19*t.amount),clientname:D.client&&D.client.name,project_number:D.project_number,title:D.title,artikel:r&&r.nominativ,street:D.street,plz:D.plz,place:D.place,contact:D.contact,adresse:c,part:D.part,contactSalut:D.contact?"Herr"===D.contact.substring(0,4)?"sehr geehrter ".concat(D.contact):"Frau"===D.contact.substring(0,4)?"sehr geehrte ".concat(D.contact):"":"Sehr geehrte Damen und Herren"};return"word"===e.action.icon?Object(v.jsx)(he,{filepath:me,filename:"".concat(t.invoice_number,".docx"),data:a,render:function(e){return Object(v.jsx)(d.a,{name:"file word",size:"large",color:"blue",style:{cursor:"pointer"},onClick:function(){return e()}})}}):Object(v.jsx)(K.a,{content:e.action.tooltip,trigger:Object(v.jsx)(d.a,{color:e.action.color,style:{cursor:"pointer"},size:"large",name:e.action.icon,onClick:function(t){return e.action.onClick(t,e.data)}})})}},data:o,options:{actionsColumnIndex:-1,sorting:!0,showTitle:!0,toolbar:!0,pageSize:7,search:!1,padding:"dense"}}),Object(v.jsxs)(z.a,{open:W,onClose:function(){return q(!1)},children:[Object(v.jsx)(z.a.Header,{children:"Rechnung l\xf6schen"}),Object(v.jsxs)(z.a.Content,{children:["Rechnung ",J.title," wirklich l\xf6schen ?"]}),Object(v.jsxs)(z.a.Actions,{children:[Object(v.jsx)(F.a,{negative:!0,onClick:function(){return q(!1)},children:"Disagree"}),Object(v.jsx)(F.a,{positive:!0,onClick:function(){return Y(J.id)},children:"Agree"})]})]}),Object(v.jsx)(z.a,{open:h,onClose:function(){return O(!1)},children:Object(v.jsx)(ge,{invoiceID:J.id})}),Object(v.jsx)(z.a,{open:j,onClose:function(){return b(!1)},children:Object(v.jsx)(xe,{})})]})},ye=n(640);var we=function(e){var t=e.projectID,n=g((function(e){return[e.projectdata,e.setProjectdata]})),c=Object(s.a)(n,2),a=c[0],o=c[1],i=g((function(e){return[e.projectsteps,e.setProjectsteps]})),u=Object(s.a)(i,2),l=u[0],j=u[1],b=function(){var e=Object(C.a)(k.a.mark((function e(){var t;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,R.get("status");case 3:t=e.sent,j(t.data),e.next=10;break;case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",e.t0.message);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),p=function(){var e=Object(C.a)(k.a.mark((function e(n){var r;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,R.put("projects/".concat(t,"/"),{status:n,title:a.title,project_number:a.project_number});case 3:r=e.sent,o(r.data),e.next=11;break;case 7:return e.prev=7,e.t0=e.catch(0),console.log(e.t0.response),e.abrupt("return",e.t0.message);case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),f=l.map((function(e){return ye.isEmpty(a)?null:Object(v.jsxs)(le.a,{completed:6!==a.status&&a.status>=e.order,active:a.status<5?a.status+1===e.order:a.status>=5&&e.order>=5&&a.status===e.order,onClick:function(){p(e.order)},children:[Object(v.jsx)(d.a,{name:e.icontext,color:6===a.status&&6===e.order?"red":"black"}),Object(v.jsxs)(le.a.Content,{children:[Object(v.jsx)(le.a.Title,{children:e.name}),Object(v.jsx)(le.a.Description,{children:e.subtext})]})]},e.id)}));return Object(r.useEffect)((function(){b()}),[]),Object(v.jsx)(v.Fragment,{children:f})},ke=n(1217);var Ce=function(){var e=Object(b.g)(),t=g((function(e){return e.projectdata})),n=g((function(e){return e.setEditModalOpen})),c=Object(r.useState)({title:t.title,place:t.place,street:t.street,plz:t.plz,part:t.part,contact:t.contact&&t.contact.substring(5),client:t.client&&t.client.id}),a=Object(s.a)(c,2),o=a[0],i=a[1],u=[{value:1,text:"Herr"},{value:2,text:"Frau"}],j=Object(r.useState)(t.contact&&"Herr"===t.contact.substring(0,4)?u[0]:u[1]),d=Object(s.a)(j,2),p=d[0],f=d[1],h=Object(r.useState)([]),O=Object(s.a)(h,2),x=O[0],m=O[1],y=Object(r.useState)(""),w=Object(s.a)(y,1)[0],S=function(){var e=Object(C.a)(k.a.mark((function e(){var t;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,R.get("/clients/");case 3:t=e.sent,m(t.data.map((function(e){return{value:e.id,image:e.image,short:e.short,text:e.name}}))),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0.response);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),_=function(){var r=Object(C.a)(k.a.mark((function r(){return k.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,R.put("/projectupdate/".concat(t.id,"/"),Object(L.a)(Object(L.a)({},o),{},{title:o.title,client:o.client,contact:o.contact?p.text+" "+o.contact:null,place:o.place?o.place:null,street:o.street?o.street:null,plz:o.plz?o.plz:null,part:o.part?o.part:null}));case 3:r.next=10;break;case 5:r.prev=5,r.t0=r.catch(0),console.log(r.t0),401===r.t0.response.status&&e.push("/login"),console.log(r.t0.response);case 10:n(!1);case 11:case"end":return r.stop()}}),r,null,[[0,5]])})));return function(){return r.apply(this,arguments)}}();return Object(r.useEffect)((function(){S()}),[]),Object(v.jsxs)(v.Fragment,{children:[Object(v.jsxs)(z.a.Header,{children:["Projekt: ",Object(v.jsx)("span",{style:{color:"red"},children:t.title})]}),Object(v.jsx)(z.a.Content,{children:Object(v.jsxs)(E.a,{children:[Object(v.jsx)(E.a.Field,{label:"Title",control:W.a,value:o.title,error:w.name&&{content:w.name,pointing:"below"},onChange:function(e){return i((function(t){return Object(L.a)(Object(L.a)({},t),{},{title:e.target.value})}))},placeholder:"Title"}),Object(v.jsx)(E.a.Field,{search:!0,selection:!0,control:l.a,value:o.client,label:"Kunde",error:w.client&&{content:w.client,pointing:"below"},onChange:function(e,t){return i((function(e){return Object(L.a)(Object(L.a)({},e),{},{client:t.value})}))},options:x,fluid:!0,placeholder:"Kunde ausw\xe4hlen"}),Object(v.jsx)(E.a.Field,{label:"Ort",control:W.a,value:o.place,onChange:function(e){return i((function(t){return Object(L.a)(Object(L.a)({},t),{},{place:e.target.value})}))},placeholder:"Ort"}),Object(v.jsx)(E.a.Field,{label:"Stra\xdfe + Hausnummer",control:W.a,value:o.street,onChange:function(e){return i((function(t){return Object(L.a)(Object(L.a)({},t),{},{street:e.target.value})}))},placeholder:"Stra\xdfe"}),Object(v.jsxs)(E.a.Group,{children:[Object(v.jsx)(E.a.Field,{width:4,selection:!0,control:l.a,value:p.value,label:"Anrede",error:w.client&&{content:w.client,pointing:"below"},onChange:function(e,t){f(1===t.value?u[0]:u[1])},options:[{value:1,text:"Herr"},{value:2,text:"Frau"}],fluid:!0}),Object(v.jsx)(E.a.Field,{width:12,label:"Kontaktperson",control:W.a,value:o.contact,onChange:function(e){return i((function(t){return Object(L.a)(Object(L.a)({},t),{},{contact:e.target.value})}))},placeholder:"z.B. Dr. M\xfcller"})]}),Object(v.jsx)(E.a.Field,{label:"Abteilung",control:W.a,value:o.part,onChange:function(e){return i((function(t){return Object(L.a)(Object(L.a)({},t),{},{part:e.target.value})}))},placeholder:"z.B. Herr Dr. M\xfcller"}),Object(v.jsx)(E.a.Field,{label:"Postleitzahl",control:W.a,value:o.plz,onChange:function(e){return i((function(t){return Object(L.a)(Object(L.a)({},t),{},{plz:e.target.value})}))},placeholder:"plz"})]})}),Object(v.jsxs)(z.a.Actions,{children:[Object(v.jsx)(F.a,{negative:!0,onClick:function(){return n(!1)},children:"Abbrechen"}),Object(v.jsx)(F.a,{positive:!0,onClick:function(){return _()},children:"Projekt updated"})]})]})};var Se=function(){var e=g((function(e){return e.projectdata})),t=g((function(e){return e.projectHonorar})),n=g((function(e){return e.setCreateOfferModel})),c=Object(r.useState)([]),a=Object(s.a)(c,2),o=a[0],i=a[1],u=Object(r.useState)([]),j=Object(s.a)(u,2),d=j[0],b=j[1],p=Object(r.useState)([]),f=Object(s.a)(p,2),h=f[0],O=f[1],x=Object(r.useState)(),m=Object(s.a)(x,2),y=m[0],w=m[1],S=Object(r.useState)(),_=Object(s.a)(S,2),I=_[0],D=_[1],A=Object(r.useState)(),M=Object(s.a)(A,2),P=M[0],T=M[1],H=Object(r.useState)([]),K=Object(s.a)(H,2),U=K[0],B=K[1],N=Object(r.useState)({}),V=Object(s.a)(N,2),q=V[0],Z=V[1],G=new Date,J=(new Date).setDate(G.getDate()+30),Q=new Date(J),X=Object(r.useState)({title:e.title,place:e.place,date:G.toLocaleDateString("de-DE"),dateTo:Q.toLocaleDateString("de-DE"),client_name:e.client.name,client_image:{isImage:!0,url:e.client.image,width:100,height:100},project_number:e.project_number,project_numbers:e.project_number,honorar:t,honorarstring:t.toLocaleString("de-DE",{style:"currency",currency:"EUR"}),suply:350,suplystring:350..toLocaleString("de-DE",{style:"currency",currency:"EUR"})}),Y=Object(s.a)(X,2),$=Y[0],ee=Y[1],te=function(){var e=Object(C.a)(k.a.mark((function e(){var t;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,R.get("templates/");case 3:t=e.sent,B(t.data.map((function(e){return{value:e.id,text:e.name,code:e.code,template:e.template}}))),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0.response);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),ne=function(){var t=Object(C.a)(k.a.mark((function t(){var n;return k.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,R.get("artikel/");case 3:n=t.sent,ee((function(t){return Object(L.a)(Object(L.a)({},t),n.data.find((function(t){return t.id===e.client.artikel})))})),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.log(t.t0.response);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(){return t.apply(this,arguments)}}(),re=function(){var e=Object(C.a)(k.a.mark((function e(){var t;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,R.get("skill/");case 3:t=e.sent,b(t.data),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0.response);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),ce=function(){var e=Object(C.a)(k.a.mark((function e(){var t;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,R.get("crew/");case 3:t=e.sent,i(t.data.map((function(e){return{value:e.id,image:e.image,text:e.short,name:e.name,role:e.role,mobile:e.mobile}}))),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0.response);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();return Object(r.useEffect)((function(){ce(),re(),ne(),te()}),[]),Object(r.useEffect)((function(){var e=o.filter((function(e){return h.includes(e.value)})).map((function(e){return{crew_name:e.name,crew_role:e.role,crew_mobile:e.mobile,crew_image:{isImage:!0,url:e.image,width:120,height:140},crew_skills:d.filter((function(t){return t.crew===e.value}))}}));ee((function(t){return Object(L.a)(Object(L.a)({},t),{},{crew:e})}))}),[h]),Object(v.jsxs)(v.Fragment,{children:[Object(v.jsxs)(z.a.Header,{children:["Projekt: ",Object(v.jsx)("span",{style:{color:"red"},children:e.title})]}),Object(v.jsx)(z.a.Content,{children:Object(v.jsxs)(E.a,{children:[Object(v.jsx)(E.a.Field,{selection:!0,control:l.a,label:"Projektart",fluid:!0,placeholder:"Art ausw\xe4hlen",options:U,value:y,onChange:function(e,t){var n=t.value;t.code;T(e.target.getAttribute("code")),w(n),Z(U.find((function(e){return e.value===n})))}}),Object(v.jsxs)(E.a.Field,{children:[Object(v.jsx)("label",{children:"Honorar"}),Object(v.jsx)(Oe.a,{placeholder:"Betrag in \u20ac (netto)",value:$.honorar,onValueChange:function(e){console.log(e);var t=e.value,n=e.floatValue;ee((function(e){return Object(L.a)(Object(L.a)({},e),{},{honorar:t,honorarstring:n&&n.toLocaleString("de-DE",{style:"currency",currency:"EUR"})})}))},isNumericString:!0,decimalScale:2,thousandSeparator:".",decimalSeparator:",",prefix:"\u20ac ",customInput:W.a})]}),Object(v.jsxs)(E.a.Field,{children:[Object(v.jsx)("label",{children:"Reisekosten"}),Object(v.jsx)(Oe.a,{placeholder:"Betrag in \u20ac (netto)",value:$.suply,onValueChange:function(e){var t=e.value,n=e.floatValue;ee((function(e){return Object(L.a)(Object(L.a)({},e),{},{suply:t,suplystring:n&&n.toLocaleString("de-DE",{style:"currency",currency:"EUR"})})}))},isNumericString:!0,decimalScale:2,thousandSeparator:".",decimalSeparator:",",prefix:"\u20ac ",customInput:W.a})]}),Object(v.jsx)(E.a.Field,{multiple:!0,selection:!0,control:l.a,label:"Projektteam",fluid:!0,placeholder:"Team ausw\xe4hlen",options:o,value:h,onChange:function(e,t){var n=t.value;return O(n)}}),Object(v.jsx)(E.a.Field,{selection:!0,control:l.a,label:"Zahlung",fluid:!0,placeholder:"Zahlungsmodalit\xe4t ausw\xe4hlen",options:[{value:0,text:"Rein netto, 14 Tage nach Rechnungseingang."},{value:1,text:"50% des Honorars werden nach Erstellung der Vergabeunterlagen, die verbleibenden 50% bei Projektabschluss (Zuschlagserteilung) berechnet. Rein netto, 14 Tage nach Rechnungseingang."},{value:2,text:"50% des Honorars werden nach Fertigstellung der IST-Analyse, die verbleibenden 50% bei Projektabschluss berechnet. Rein netto, 14 Tage nach Rechnungseingang."}],value:I,onChange:function(e,t){var n=t.value;D(n),ee((function(t){return Object(L.a)(Object(L.a)({},t),{},{modalstring:e.target.innerText})}))}})]})}),Object(v.jsxs)(z.a.Actions,{children:[Object(v.jsx)(F.a,{negative:!0,onClick:function(){return n(!1)},children:"Abbrechen"}),Object(v.jsx)(he,{filepath:q.template,filename:"Angebot-".concat(P,"-").concat(e.project_number,".docx"),data:$,render:function(e){return Object(v.jsx)(F.a,{disabled:!(null!=P&&h.length>0&&null!=I),icon:"file word",content:"offer",color:"blue",style:{marginBottom:".3rem"},onClick:function(){return e()}})}})]})]})},_e=n(640);var Ee=function(e){var t=e.projectID,n=g((function(e){return[e.projectdata,e.setProjectdata]})),c=Object(s.a)(n,2),a=c[0],o=c[1],i=g((function(e){return[e.projectHonorar,e.setProjectHonorar]})),u=Object(s.a)(i,2),l=u[0],j=u[1],b=g((function(e){return[e.editModalOpen,e.setEditModalOpen]})),p=Object(s.a)(b,2),f=p[0],h=p[1],O=g((function(e){return[e.createOfferModel,e.setCreateOfferModel]})),x=Object(s.a)(O,2),m=x[0],y=x[1],w=g((function(e){return e.invoices}));Object(r.useEffect)((function(){if(w){var e=0;w.forEach((function(t){return e+=parseFloat(t.amount)})),j(e)}}),[w]);var S=function(){var e=Object(C.a)(k.a.mark((function e(){var n;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,R.get("projects/".concat(t,"/"));case 3:n=e.sent,o(n.data),e.next=10;break;case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",e.t0.message);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),_=new Date(a.created_at).toLocaleDateString("de",{hour:"numeric",minute:"numeric"});return Object(r.useEffect)((function(){S()}),[f]),_e.isEmpty(a)?Object(v.jsx)(je.a,{active:!0,inverted:!0,children:Object(v.jsx)(de.a,{size:"medium",children:"Loading"})}):Object(v.jsxs)(v.Fragment,{children:[Object(v.jsxs)(ke.a,{divided:!0,relaxed:!0,children:[Object(v.jsx)(ke.a.Item,{children:Object(v.jsxs)(ke.a.Content,{children:[Object(v.jsx)(ke.a.Header,{as:"h2",children:a.title}),Object(v.jsxs)(ke.a.Description,{as:"p",style:{marginBottom:0},children:[Object(v.jsx)("strong",{children:"Erstellt:"})," ",_]}),Object(v.jsxs)(ke.a.Description,{as:"p",children:[Object(v.jsx)("strong",{children:"Projektnr:"})," ",a.project_number]})]})}),Object(v.jsxs)(ke.a.Item,{children:[Object(v.jsx)(q.a,{rounded:!0,style:{width:"23.625px",marginRight:"6px"},src:a.client&&a.client.image}),Object(v.jsx)(ke.a.Content,{children:Object(v.jsx)(ke.a.Header,{as:"h3",children:a.client?a.client.name:"NO CLIENT"})})]}),Object(v.jsxs)(ke.a.Item,{children:[Object(v.jsx)(ke.a.Icon,{name:"eur",size:"large",verticalAlign:"middle"}),Object(v.jsxs)(ke.a.Content,{children:[Object(v.jsx)(ke.a.Header,{style:{marginLeft:"11px"},as:"h4",children:"Honorar"}),Object(v.jsx)(ke.a.Description,{style:{marginLeft:"11px"},children:Object(v.jsx)("strong",{style:{color:"green"},children:l&&l.toLocaleString("de")+" \u20ac"})})]})]}),Object(v.jsxs)(ke.a.Item,{children:[Object(v.jsx)(ke.a.Icon,{name:"map",size:"large",verticalAlign:"middle"}),Object(v.jsxs)(ke.a.Content,{children:[Object(v.jsx)(ke.a.Header,{as:"h4",children:"Anschrift"}),Object(v.jsxs)(ke.a.Description,{children:[Object(v.jsx)("strong",{children:"Stra\xdfe: "}),a.street," ",a.street&&Object(v.jsx)(d.a,{color:"green",name:"check"})]}),Object(v.jsxs)(ke.a.Description,{children:[Object(v.jsx)("strong",{children:"Plz: "}),a.plz," ",a.plz&&Object(v.jsx)(d.a,{color:"green",name:"check"})]}),Object(v.jsxs)(ke.a.Description,{children:[Object(v.jsx)("strong",{children:"Ort: "}),a.place," ",a.place&&Object(v.jsx)(d.a,{color:"green",name:"check"})]}),Object(v.jsxs)(ke.a.Description,{children:[Object(v.jsx)("strong",{children:"Kontakt: "}),a.contact," ",a.contact&&Object(v.jsx)(d.a,{color:"green",name:"check"})]}),Object(v.jsxs)(ke.a.Description,{children:[Object(v.jsx)("strong",{children:"Abteilung: "}),a.part," ",a.part&&Object(v.jsx)(d.a,{color:"green",name:"check"})]})]})]}),Object(v.jsx)(ke.a.Item,{children:Object(v.jsxs)(ke.a.Content,{children:[Object(v.jsx)(F.a,{style:{marginBottom:".3rem"},icon:"edit",content:"edit",onClick:function(){return h(!0)}}),Object(v.jsx)(F.a,{disabled:null===a.client,icon:"file word",content:"create",onClick:function(){return y(!0)}})]})})]}),Object(v.jsx)(z.a,{open:f,children:Object(v.jsx)(Ce,{})}),Object(v.jsx)(z.a,{open:m,children:Object(v.jsx)(Se,{})})]})};var Fe=function(e){var t=e.match.params.id;return Object(v.jsx)(S.a,{stackable:!0,columns:3,children:Object(v.jsxs)(S.a.Row,{style:{minHeight:"343px"},stretched:!0,children:[Object(v.jsx)(S.a.Column,{computer:4,tablet:16,children:Object(v.jsx)(V.a,{children:Object(v.jsx)(Ee,{projectID:t})})}),Object(v.jsx)(S.a.Column,{computer:4,tablet:16,children:Object(v.jsx)(V.a,{children:Object(v.jsx)(le.a.Group,{fluid:!0,vertical:!0,children:Object(v.jsx)(we,{projectID:t})})})}),Object(v.jsx)(S.a.Column,{computer:8,tablet:16,children:Object(v.jsx)(V.a,{children:Object(v.jsx)(ve,{projectID:t})})})]})})};var Ie=function(){var e=g((function(e){return[e.invoices,e.setInvoices]})),t=Object(s.a)(e,2),n=t[0],c=t[1],a=Object(r.useState)([]),o=Object(s.a)(a,2),i=o[0],u=o[1],l=g((function(e){return[e.invoiceStati,e.setInvoiceStati]})),j=Object(s.a)(l,2),b=j[0],f=j[1],h=g((function(e){return[e.invoiceEditModel,e.setInvoiceEditModel]})),O=Object(s.a)(h,2),x=O[0],m=O[1],y=Object(r.useState)(),w=Object(s.a)(y,2),S=w[0],_=w[1],E=Object(r.useState)({projects:!0,invoices:!0}),F=Object(s.a)(E,2),I=F[0],D=F[1],A=function(){var e=Object(C.a)(k.a.mark((function e(){var t;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,R.get("projects/");case 3:t=e.sent,u(t.data),D((function(e){return Object(L.a)(Object(L.a)({},e),{},{projects:!1})})),console.log(t.data),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.log(e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}(),M=function(){var e=Object(C.a)(k.a.mark((function e(){var t;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,R.get("invoicesall/");case 3:t=e.sent,c(t.data),D((function(e){return Object(L.a)(Object(L.a)({},e),{},{invoices:!1})})),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0.response);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}(),P=function(){var e=Object(C.a)(k.a.mark((function e(){var t;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,R.get("/invoicestatus/");case 3:t=e.sent,f(t.data.map((function(e){return{value:e.id,text:e.name,icon:e.icontext}}))),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();return Object(r.useEffect)((function(){M(),P(),A()}),[x]),Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)(H.a,{isLoading:I.projects||I.invoices,title:"Rechnungen",columns:[{title:"ID",field:"id"},{title:"Name",field:"title",render:function(e){return Object(v.jsx)(v.Fragment,{children:e.title.length>10?Object(v.jsx)(K.a,{content:e.title,trigger:Object(v.jsx)("p",{children:e.title.slice(0,10)+"..."})}):Object(v.jsx)("p",{children:e.title})})}},{title:"Rechnungsnummer",field:"invoice_number"},{title:"Projekt",field:"project",render:function(e){var t=i.find((function(t){return t.id===e.project}));return Object(v.jsx)(v.Fragment,{children:t&&t.title.length>17?Object(v.jsx)(K.a,{content:t&&t.title,trigger:Object(v.jsx)(p.b,{to:"/projects/".concat(t&&t.id),children:t.title.slice(0,17)+"..."})}):t&&Object(v.jsx)(p.b,{to:"/projects/".concat(t&&t.id),children:t.title})})}},{title:"Kunde",field:"invoice_number",render:function(e){var t=i.find((function(t){return t.id===e.project}));return Object(v.jsx)("p",{children:t&&t.client.name})}},{title:"Status",field:"status",lookup:{1:"angelegt",2:"gestellt",3:"erhalten"},render:function(e){var t=b.find((function(t){return t.value===e.status}));return Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)("span",{style:{marginRight:".2rem"},children:t&&t.text}),Object(v.jsx)(d.a,{color:t&&3===t.value?"green":t&&2===t.value?"yellow":"black",name:t&&t.icon})]})}},{title:"Offen (Tagen)",field:"date_of_invoicing",filtering:!1,render:function(e){var t=new Date,n=new Date(e.date_of_invoicing),r=(t.getTime()-n.getTime())/864e5;return 3!==e.status&&e.date_of_invoicing?Math.trunc(r):"-"}},{title:"Rechnungsstellung",field:"date_of_invoicing",type:"date",dateSetting:{locale:"de"},render:function(e){return e.date_of_invoicing?new Date(e.date_of_invoicing).toLocaleDateString("de"):"-"}},{title:"Zahlungseingang",field:"date_of_payment",render:function(e){return Object(v.jsx)("span",{style:{color:3===e.status?"#016936":"#CFCCD6"},children:e.date_of_payment?new Date(e.date_of_payment).toLocaleDateString("de"):"-"})}},{title:"Betrag",field:"amount",type:"currency",currencySetting:{locale:"de",currencyCode:"EUR"}}],actions:[{icon:"edit",color:"grey",tooltip:"edit",onClick:function(e,t){_(t.id),m(!0)}}],data:n,options:{filtering:!0,actionsColumnIndex:-1,sorting:!0,exportButton:!0,pageSize:10,padding:"dense"}}),Object(v.jsx)(z.a,{open:x,onClose:function(){return m(!1)},children:Object(v.jsx)(ge,{invoiceID:S})})]})};var De=function(){return Object(v.jsx)(v.Fragment,{children:Object(v.jsx)(Ie,{})})},Re=n(1206),Ae=n(1220),Le=n(1210),Me=n(772),Pe=n(773),ze=n(771),Te=n(325),He=n(769);function Ke(e,t){var n=e.data;return Object(v.jsx)(Re.a,{ref:t,children:Object(v.jsxs)(Ae.a,{data:n,margin:{top:10,right:30,left:30,bottom:10},children:[Object(v.jsx)(Le.a,{strokeDasharray:"3 3"}),Object(v.jsx)(Me.a,{dataKey:"date"}),Object(v.jsx)(Pe.a,{yAxisId:"left",orientation:"left",stroke:"#2089C6",tickFormatter:function(e){return e.toLocaleString("de-DE",{style:"currency",currency:"EUR",maximumFractionDigits:0})}}),Object(v.jsx)(Pe.a,{yAxisId:"right",orientation:"right",stroke:"#30343F",tickFormatter:function(e){return e.toLocaleString("de-DE",{style:"currency",currency:"EUR",maximumFractionDigits:0})}}),Object(v.jsx)(ze.a,{yAxisId:"left",dataKey:"costs",fill:"#2089C6",too:!0}),Object(v.jsx)(ze.a,{yAxisId:"left",dataKey:"income",fill:"#519599"}),Object(v.jsx)(Te.a,{formatter:function(e){return e.toLocaleString("de-DE",{style:"currency",currency:"EUR",maximumFractionDigits:0})}}),Object(v.jsx)(He.a,{yAxisId:"right",type:"monotone",dataKey:"balance",stroke:"#30343F"})]})})}var Ue=Object(r.forwardRef)(Ke),Be=n(1222),Ne=n(320),Ve=n(1221),We=n(774),qe=function(e){var t=Math.PI/180,n=e.cx,r=e.cy,c=e.midAngle,a=e.innerRadius,o=e.outerRadius,i=e.startAngle,s=e.endAngle,u=e.fill,l=e.payload,j=e.percent,d=e.value,b=Math.sin(-t*c),p=Math.cos(-t*c),f=n+(o+10)*p,h=r+(o+10)*b,O=n+(o+30)*p,x=r+(o+30)*b,g=O+22*(p>=0?1:-1),m=x,y=p>=0?"start":"end";return Object(v.jsxs)("g",{children:[Object(v.jsx)("text",{x:n,y:r,dy:8,textAnchor:"middle",fill:u,children:l.region}),Object(v.jsx)(Ne.a,{cx:n,cy:r,innerRadius:a,outerRadius:o,startAngle:i,endAngle:s,fill:u}),Object(v.jsx)(Ne.a,{cx:n,cy:r,startAngle:i,endAngle:s,innerRadius:o+6,outerRadius:o+10,fill:u}),Object(v.jsx)("path",{d:"M".concat(f,",").concat(h,"L").concat(O,",").concat(x,"L").concat(g,",").concat(m),stroke:u,fill:"none"}),Object(v.jsx)("circle",{cx:g,cy:m,r:2,fill:u,stroke:"none"}),Object(v.jsx)("text",{x:g+12*(p>=0?1:-1),y:m,textAnchor:y,fill:"#333",children:"".concat(d.toLocaleString("de-DE",{style:"currency",currency:"EUR"}))}),Object(v.jsx)("text",{x:g+12*(p>=0?1:-1),y:m,dy:18,textAnchor:y,fill:"#999",children:"".concat((100*j).toFixed(2),"%")})]})};var Ze=function(e){var t=e.graphwidth,n=e.graphheight,c=e.data,a=Object(r.useState)(0),o=Object(s.a)(a,2),i=o[0],u=o[1],l=Object(r.useCallback)((function(e,t){u(t)}),[u]);return Object(v.jsx)(Ve.a,{width:t,height:n,children:Object(v.jsx)(We.a,{activeIndex:i,activeShape:qe,data:c.map((function(e){return Object(L.a)(Object(L.a)({},e),{},{amount_per_month:parseFloat(e.amount_per_month)})})),cx:t/2,cy:n/2,innerRadius:65,outerRadius:75,fill:"#8884d8",dataKey:"amount_per_month",onMouseEnter:l})})},Ge=n(199),Je=n.n(Ge),Qe=Je.a.ExcelFile,Xe=Je.a.ExcelFile.ExcelSheet,Ye=Je.a.ExcelFile.ExcelColumn;var $e=function(e){var t=e.data.map((function(e){var t=e.invoices.map((function(e){return e.id}));return Object(L.a)(Object(L.a)({},e),{},{invs:t.join()})}));return Object(v.jsx)(Qe,{element:Object(v.jsx)(F.a,{icon:"file excel",label:"Forecast"}),children:Object(v.jsxs)(Xe,{data:t,name:"Forecast",children:[Object(v.jsx)(Ye,{label:"Monat",value:"date"}),Object(v.jsx)(Ye,{label:"Kosten p.m. [\u20ac]",value:"costs"}),Object(v.jsx)(Ye,{label:"Einkommen p.m. [\u20ac]",value:"income"}),Object(v.jsx)(Ye,{label:"Stand [\u20ac]",value:"balance"}),Object(v.jsx)(Ye,{label:"Rechnungen [ID's]",value:"invs"})]})})},et=Je.a.ExcelFile,tt=Je.a.ExcelFile.ExcelSheet,nt=Je.a.ExcelFile.ExcelColumn;var rt=function(e){var t=e.data;return Object(v.jsx)(et,{element:Object(v.jsx)(F.a,{icon:"file excel",label:"Kosten"}),children:Object(v.jsxs)(tt,{data:t,name:"Kosten",children:[Object(v.jsx)(nt,{label:"Bereich",value:"region"}),Object(v.jsx)(nt,{label:"Kosten p.m. [\u20ac]",value:"amount_per_month"})]})})},ct=n(778),at=function(e,t){var n=(new XMLSerializer).serializeToString(e),r=new Blob([n],{type:"image/svg+xml;charset=utf-8"});Object(ct.saveAs)(r,t)},ot=function(e,t){return e+t};var it=function(){var e=Object(r.useRef)(null),t=Object(r.useRef)(null),n=Object(r.useState)(0),c=Object(s.a)(n,2),a=c[0],o=c[1],i=Object(r.useState)([]),u=Object(s.a)(i,2),j=u[0],d=u[1],b=Object(r.useState)(0),p=Object(s.a)(b,2),f=p[0],h=p[1],O=Object(r.useState)({}),x=Object(s.a)(O,2),g=x[0],m=x[1],y=Object(r.useState)([]),w=Object(s.a)(y,2),_=w[0],E=w[1],I=Object(r.useState)([]),D=Object(s.a)(I,2),A=D[0],M=D[1],P=Object(r.useState)([]),z=Object(s.a)(P,2),T=z[0],H=z[1],K=Object(r.useState)([]),U=Object(s.a)(K,2),B=U[0],N=U[1],W=Object(r.useState)([]),q=Object(s.a)(W,2),Z=q[0],G=q[1],J=Object(r.useState)([]),Q=Object(s.a)(J,2),X=Q[0],Y=Q[1],$=Object(r.useState)([]),ee=Object(s.a)($,2),te=ee[0],ne=ee[1],re=function(){var e=Object(C.a)(k.a.mark((function e(){var t,n,r,c;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,R.get("invoicesall/");case 3:return t=e.sent,e.next=6,R.get("projects/");case 6:return n=e.sent,e.next=9,R.get("types");case 9:r=e.sent,c=t.data.map((function(e){return Object(L.a)(Object(L.a)({},e),{},{project:n.data.find((function(t){return t.id===e.project}))})})),E(c),ne(n.data),Y(r.data.map((function(e){var t=0,r=0;return c.forEach((function(n){n.project.project_type===e.id&&(t+=parseFloat(n.amount))})),n.data.forEach((function(t){t.project_type===e.id&&(r+=1)})),Object(L.a)(Object(L.a)({},e),{},{counts:r,value:t})}))),e.next=19;break;case 16:e.prev=16,e.t0=e.catch(0),console.log(e.t0.response);case 19:case"end":return e.stop()}}),e,null,[[0,16]])})));return function(){return e.apply(this,arguments)}}(),ce=function(){var e=Object(C.a)(k.a.mark((function e(){var t,n;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,R.get("status");case 3:return t=e.sent,e.next=6,R.get("projects/");case 6:n=e.sent,N(t.data.map((function(e){var t=0;return n.data.forEach((function(n){n.status.id===e.id&&(t+=1)})),{key:e.id,value:e.id,text:e.name+" (".concat(t,")")}}))),G(t.data.map((function(e){return e.id}))),e.next=14;break;case 11:return e.prev=11,e.t0=e.catch(0),e.abrupt("return",e.t0.message);case 14:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(){return e.apply(this,arguments)}}(),ae=function(){var e=Object(C.a)(k.a.mark((function e(){var t;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,R.get("forecast/charges");case 3:t=e.sent,d(t.data),h(t.data.map((function(e){return parseFloat(e.amount_per_month)})).reduce(ot)),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0.response);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}(),oe=function(){var e=Object(C.a)(k.a.mark((function e(){var t;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,R.get("forecast/balance");case 3:t=e.sent,m(t.data[0]),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0.response);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();Object(r.useEffect)((function(){M(_.filter((function(e){return new Date(e.date_of_payment)>=new Date(g.date)})).map((function(e){return Object(L.a)(Object(L.a)({},e),{},{amount:parseFloat(e.amount),date_of_payment:new Date(e.date_of_payment)})})))}),[g,_]),Object(r.useEffect)((function(){var e=Z;if(0!==A.length){var t=new Array(12).fill().map((function(t,n){var r=new Date(g.date&&g.date.substring(0,7));r.setMonth(r.getMonth()+n);var c=A.filter((function(t){return new Date(t.date_of_payment).getMonth()===r.getMonth()&&e.includes(t.project.status.order)}));return{date:r.toLocaleDateString("de-DE",{year:"2-digit",month:"short"}),income:0!==c.length?c.map((function(e){return e.amount})).reduce(ot):0,costs:f,invoices:0!==c.length?c:[]}})),n=[];t.forEach((function(e,t,r){var c=0;c=0===t?parseFloat(g.amount):n[t-1].balance-r[t].costs+r[t].income,n[t]=Object(L.a)(Object(L.a)({},e),{},{balance:c})})),Y((function(e){return e.map((function(e){return Object(L.a)({},e)}))})),H(n)}}),[A,Z,j,g]),Object(r.useEffect)((function(){var e=_.filter((function(e){return Z.includes(e.project.status.id)})),t=te.filter((function(e){return Z.includes(e.status.id)}));Y((function(n){return n.map((function(n){var r=0,c=0;return e.forEach((function(e){e.project.project_type===n.id&&(r+=parseFloat(e.amount))})),t.forEach((function(e){e.project_type===n.id&&(c+=1)})),Object(L.a)(Object(L.a)({},n),{},{value:r,counts:c})}))}))}),[Z,_,te]),Object(r.useEffect)((function(){console.log("types",X)}),[X]),Object(r.useEffect)((function(){ae(),oe(),re(),ce()}),[]),Object(r.useEffect)((function(){o(e.current.clientWidth);var t=function(){o(e.current.clientWidth)};return window.addEventListener("resize",t),function(){window.removeEventListener("resize",t)}}),[]);var ie={display:"flex",alignItems:"center",justifyContent:"center"},se=X.map((function(e){return Object(v.jsx)(V.a,{style:ie,children:Object(v.jsxs)(Be.a,{size:"tiny",children:[Object(v.jsx)(Be.a.Value,{children:e.value.toLocaleString("de-DE",{style:"currency",currency:"EUR",maximumFractionDigits:0})}),Object(v.jsx)(Be.a.Label,{children:"".concat(e.name," (").concat(e.counts,")")})]})},e.id)}));return Object(v.jsxs)(S.a,{stackable:!0,columns:2,children:[Object(v.jsxs)(S.a.Row,{stretched:!0,children:[Object(v.jsx)(S.a.Column,{width:11,children:Object(v.jsx)(V.a,{style:{height:"400px"},children:Object(v.jsx)(Ue,{data:T,ref:t})})}),Object(v.jsxs)(S.a.Column,{width:5,children:[Object(v.jsx)(V.a,{style:ie,children:Object(v.jsx)(l.a,{placeholder:"Skills",value:Z,fluid:!0,multiple:!0,selection:!0,options:B,onChange:function(e,t){var n=t.value;return G(n)}})}),Object(v.jsx)(V.a,{style:ie,children:Object(v.jsx)($e,{data:T})}),Object(v.jsx)(V.a,{style:ie,children:Object(v.jsx)(rt,{data:j})}),Object(v.jsx)(V.a,{style:ie,children:Object(v.jsx)(F.a,{onClick:function(){return at(t.current.current,"Forecast")},icon:"area graph",label:"Graph"})})]})]}),Object(v.jsxs)(S.a.Row,{stretched:!0,children:[Object(v.jsx)(S.a.Column,{width:6,children:Object(v.jsx)("div",{ref:e,children:Object(v.jsx)(V.a,{style:{padding:0},children:Object(v.jsx)(Ze,{data:j,graphwidth:a,graphheight:370})})})}),Object(v.jsxs)(S.a.Column,{width:5,children:[Object(v.jsx)(V.a,{style:ie,children:Object(v.jsxs)(Be.a,{size:"tiny",children:[Object(v.jsx)(Be.a.Value,{children:parseFloat(g.amount).toLocaleString("de-DE",{style:"currency",currency:"EUR",maximumFractionDigits:0})}),Object(v.jsx)(Be.a.Label,{children:new Date(g.date).toLocaleDateString("de-DE",{year:"2-digit",month:"long"})})]})}),Object(v.jsx)(V.a,{style:ie,children:Object(v.jsxs)(Be.a,{size:"tiny",color:0!==T.length&&parseFloat(T[6].balance-g.amount)>=0?"green":"red",children:[Object(v.jsx)(Be.a.Value,{children:0!==T.length&&parseFloat(T[6].balance-g.amount).toLocaleString("de-DE",{style:"currency",currency:"EUR",maximumFractionDigits:0})}),Object(v.jsx)(Be.a.Label,{children:"\u2206 6 Monate"})]})}),Object(v.jsx)(V.a,{style:ie,children:Object(v.jsxs)(Be.a,{size:"tiny",color:0!==T.length&&parseFloat(T[11].balance-g.amount)>=0?"green":"red",children:[Object(v.jsx)(Be.a.Value,{children:0!==T.length&&parseFloat(T[11].balance-g.amount).toLocaleString("de-DE",{style:"currency",currency:"EUR",maximumFractionDigits:0})}),Object(v.jsx)(Be.a.Label,{children:"\u2206 12 Monate"})]})})]}),Object(v.jsx)(S.a.Column,{width:5,children:se})]})]})};var st=function(){var e=Object(i.useMediaQuery)({query:"(max-width: 1224px)"});return Object(v.jsx)(p.a,{children:Object(v.jsx)(y,{children:Object(v.jsx)("div",{style:{margin:e?"1rem":"2rem"},children:Object(v.jsxs)(b.d,{children:[Object(v.jsx)(P,{exact:!0,path:"/",component:oe}),Object(v.jsx)(P,{exact:!0,path:"/clients",component:ue}),Object(v.jsx)(P,{exact:!0,path:"/invoices",component:De}),Object(v.jsx)(P,{exact:!0,path:"/forecast",component:it}),Object(v.jsx)(P,{exact:!0,path:"/projects/:id",component:Fe}),Object(v.jsx)(b.b,{exact:!0,path:"/login",children:Object(v.jsx)(A,{})})]})})})})};o.a.render(Object(v.jsx)(st,{}),document.getElementById("root"))},815:function(e,t,n){}},[[1157,1,2]]]);
//# sourceMappingURL=main.f86ccac6.chunk.js.map